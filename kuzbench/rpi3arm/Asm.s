	.arch armv7-a
	.fpu vfpv3-d16
	.file	"Asm.s"
	.section	.rodata
	.align	2
	.type	_Pi, %object
	.size	_Pi, 256
_Pi:
	.byte	-4
	.byte	-18
	.byte	-35
	.byte	17
	.byte	-49
	.byte	110
	.byte	49
	.byte	22
	.byte	-5
	.byte	-60
	.byte	-6
	.byte	-38
	.byte	35
	.byte	-59
	.byte	4
	.byte	77
	.byte	-23
	.byte	119
	.byte	-16
	.byte	-37
	.byte	-109
	.byte	46
	.byte	-103
	.byte	-70
	.byte	23
	.byte	54
	.byte	-15
	.byte	-69
	.byte	20
	.byte	-51
	.byte	95
	.byte	-63
	.byte	-7
	.byte	24
	.byte	101
	.byte	90
	.byte	-30
	.byte	92
	.byte	-17
	.byte	33
	.byte	-127
	.byte	28
	.byte	60
	.byte	66
	.byte	-117
	.byte	1
	.byte	-114
	.byte	79
	.byte	5
	.byte	-124
	.byte	2
	.byte	-82
	.byte	-29
	.byte	106
	.byte	-113
	.byte	-96
	.byte	6
	.byte	11
	.byte	-19
	.byte	-104
	.byte	127
	.byte	-44
	.byte	-45
	.byte	31
	.byte	-21
	.byte	52
	.byte	44
	.byte	81
	.byte	-22
	.byte	-56
	.byte	72
	.byte	-85
	.byte	-14
	.byte	42
	.byte	104
	.byte	-94
	.byte	-3
	.byte	58
	.byte	-50
	.byte	-52
	.byte	-75
	.byte	112
	.byte	14
	.byte	86
	.byte	8
	.byte	12
	.byte	118
	.byte	18
	.byte	-65
	.byte	114
	.byte	19
	.byte	71
	.byte	-100
	.byte	-73
	.byte	93
	.byte	-121
	.byte	21
	.byte	-95
	.byte	-106
	.byte	41
	.byte	16
	.byte	123
	.byte	-102
	.byte	-57
	.byte	-13
	.byte	-111
	.byte	120
	.byte	111
	.byte	-99
	.byte	-98
	.byte	-78
	.byte	-79
	.byte	50
	.byte	117
	.byte	25
	.byte	61
	.byte	-1
	.byte	53
	.byte	-118
	.byte	126
	.byte	109
	.byte	84
	.byte	-58
	.byte	-128
	.byte	-61
	.byte	-67
	.byte	13
	.byte	87
	.byte	-33
	.byte	-11
	.byte	36
	.byte	-87
	.byte	62
	.byte	-88
	.byte	67
	.byte	-55
	.byte	-41
	.byte	121
	.byte	-42
	.byte	-10
	.byte	124
	.byte	34
	.byte	-71
	.byte	3
	.byte	-32
	.byte	15
	.byte	-20
	.byte	-34
	.byte	122
	.byte	-108
	.byte	-80
	.byte	-68
	.byte	-36
	.byte	-24
	.byte	40
	.byte	80
	.byte	78
	.byte	51
	.byte	10
	.byte	74
	.byte	-89
	.byte	-105
	.byte	96
	.byte	115
	.byte	30
	.byte	0
	.byte	98
	.byte	68
	.byte	26
	.byte	-72
	.byte	56
	.byte	-126
	.byte	100
	.byte	-97
	.byte	38
	.byte	65
	.byte	-83
	.byte	69
	.byte	70
	.byte	-110
	.byte	39
	.byte	94
	.byte	85
	.byte	47
	.byte	-116
	.byte	-93
	.byte	-91
	.byte	125
	.byte	105
	.byte	-43
	.byte	-107
	.byte	59
	.byte	7
	.byte	88
	.byte	-77
	.byte	64
	.byte	-122
	.byte	-84
	.byte	29
	.byte	-9
	.byte	48
	.byte	55
	.byte	107
	.byte	-28
	.byte	-120
	.byte	-39
	.byte	-25
	.byte	-119
	.byte	-31
	.byte	27
	.byte	-125
	.byte	73
	.byte	76
	.byte	63
	.byte	-8
	.byte	-2
	.byte	-115
	.byte	83
	.byte	-86
	.byte	-112
	.byte	-54
	.byte	-40
	.byte	-123
	.byte	97
	.byte	32
	.byte	113
	.byte	103
	.byte	-92
	.byte	45
	.byte	43
	.byte	9
	.byte	91
	.byte	-53
	.byte	-101
	.byte	37
	.byte	-48
	.byte	-66
	.byte	-27
	.byte	108
	.byte	82
	.byte	89
	.byte	-90
	.byte	116
	.byte	-46
	.byte	-26
	.byte	-12
	.byte	-76
	.byte	-64
	.byte	-47
	.byte	102
	.byte	-81
	.byte	-62
	.byte	57
	.byte	75
	.byte	99
	.byte	-74
	.align	2
	.type	_reverse_Pi, %object
	.size	_reverse_Pi, 256
_reverse_Pi:
	.byte	-91
	.byte	45
	.byte	50
	.byte	-113
	.byte	14
	.byte	48
	.byte	56
	.byte	-64
	.byte	84
	.byte	-26
	.byte	-98
	.byte	57
	.byte	85
	.byte	126
	.byte	82
	.byte	-111
	.byte	100
	.byte	3
	.byte	87
	.byte	90
	.byte	28
	.byte	96
	.byte	7
	.byte	24
	.byte	33
	.byte	114
	.byte	-88
	.byte	-47
	.byte	41
	.byte	-58
	.byte	-92
	.byte	63
	.byte	-32
	.byte	39
	.byte	-115
	.byte	12
	.byte	-126
	.byte	-22
	.byte	-82
	.byte	-76
	.byte	-102
	.byte	99
	.byte	73
	.byte	-27
	.byte	66
	.byte	-28
	.byte	21
	.byte	-73
	.byte	-56
	.byte	6
	.byte	112
	.byte	-99
	.byte	65
	.byte	117
	.byte	25
	.byte	-55
	.byte	-86
	.byte	-4
	.byte	77
	.byte	-65
	.byte	42
	.byte	115
	.byte	-124
	.byte	-43
	.byte	-61
	.byte	-81
	.byte	43
	.byte	-122
	.byte	-89
	.byte	-79
	.byte	-78
	.byte	91
	.byte	70
	.byte	-45
	.byte	-97
	.byte	-3
	.byte	-44
	.byte	15
	.byte	-100
	.byte	47
	.byte	-101
	.byte	67
	.byte	-17
	.byte	-39
	.byte	121
	.byte	-74
	.byte	83
	.byte	127
	.byte	-63
	.byte	-16
	.byte	35
	.byte	-25
	.byte	37
	.byte	94
	.byte	-75
	.byte	30
	.byte	-94
	.byte	-33
	.byte	-90
	.byte	-2
	.byte	-84
	.byte	34
	.byte	-7
	.byte	-30
	.byte	74
	.byte	-68
	.byte	53
	.byte	-54
	.byte	-18
	.byte	120
	.byte	5
	.byte	107
	.byte	81
	.byte	-31
	.byte	89
	.byte	-93
	.byte	-14
	.byte	113
	.byte	86
	.byte	17
	.byte	106
	.byte	-119
	.byte	-108
	.byte	101
	.byte	-116
	.byte	-69
	.byte	119
	.byte	60
	.byte	123
	.byte	40
	.byte	-85
	.byte	-46
	.byte	49
	.byte	-34
	.byte	-60
	.byte	95
	.byte	-52
	.byte	-49
	.byte	118
	.byte	44
	.byte	-72
	.byte	-40
	.byte	46
	.byte	54
	.byte	-37
	.byte	105
	.byte	-77
	.byte	20
	.byte	-107
	.byte	-66
	.byte	98
	.byte	-95
	.byte	59
	.byte	22
	.byte	102
	.byte	-23
	.byte	92
	.byte	108
	.byte	109
	.byte	-83
	.byte	55
	.byte	97
	.byte	75
	.byte	-71
	.byte	-29
	.byte	-70
	.byte	-15
	.byte	-96
	.byte	-123
	.byte	-125
	.byte	-38
	.byte	71
	.byte	-59
	.byte	-80
	.byte	51
	.byte	-6
	.byte	-106
	.byte	111
	.byte	110
	.byte	-62
	.byte	-10
	.byte	80
	.byte	-1
	.byte	93
	.byte	-87
	.byte	-114
	.byte	23
	.byte	27
	.byte	-105
	.byte	125
	.byte	-20
	.byte	88
	.byte	-9
	.byte	31
	.byte	-5
	.byte	124
	.byte	9
	.byte	13
	.byte	122
	.byte	103
	.byte	69
	.byte	-121
	.byte	-36
	.byte	-24
	.byte	79
	.byte	29
	.byte	78
	.byte	4
	.byte	-21
	.byte	-8
	.byte	-13
	.byte	62
	.byte	61
	.byte	-67
	.byte	-118
	.byte	-120
	.byte	-35
	.byte	-51
	.byte	11
	.byte	19
	.byte	-104
	.byte	2
	.byte	-109
	.byte	-128
	.byte	-112
	.byte	-48
	.byte	36
	.byte	52
	.byte	-53
	.byte	-19
	.byte	-12
	.byte	-50
	.byte	-103
	.byte	16
	.byte	68
	.byte	64
	.byte	-110
	.byte	58
	.byte	1
	.byte	38
	.byte	18
	.byte	26
	.byte	72
	.byte	104
	.byte	-11
	.byte	-127
	.byte	-117
	.byte	-57
	.byte	-42
	.byte	32
	.byte	10
	.byte	8
	.byte	0
	.byte	76
	.byte	-41
	.byte	116
	.align	2

	.type	_l_vec, %object
	.size	_l_vec, 16
_l_vec:
	.byte	1
	.byte	-108
	.byte	32
	.byte	-123
	.byte	16
	.byte	-62
	.byte	-64
	.byte	1
	.byte	-5
	.byte	1
	.byte	-64
	.byte	-62
	.byte	16
	.byte	-123
	.byte	32
	.byte	-108
	.align	2

	.global	_iter_C
	.bss
	.align	2
	.type	_iter_C, %object
	.size	_iter_C, 512
_iter_C:
	.space	512
	.align	2

	.global	_iter_key
	.align	2
	.type	_iter_key, %object
	.size	_iter_key, 160
_iter_key:
	.space	160
	.align	2

	.text
	.align	2
	.global	_GOST_Kuz_S
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_S, %function
_GOST_Kuz_S:
	.fnstart
	push {r3,r4}
	movw	r4, #:lower16:_Pi
	movt	r4, #:upper16:_Pi
	mov r3, 0
.cycle1:	
	cmp	r3, #15                @i > 15 ?
	bgt.n	.exit1
	ldrb	r2, [r0,r3]        @r2 = in_data[i]
	ldrb r2, [r4, r2]          @r2 = Pi[in_data[i]];
	strb r2, [r1,r3]
	adds	r3, #1
	b .cycle1
.exit1:
	nop
	pop {r3,r4}
	bx       lr
	.fnend
	.global	_GOST_Kuz_reverse_S
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_reverse_S, %function
_GOST_Kuz_reverse_S:
	.fnstart
	push {r3,r4}
	movw	r4, #:lower16:_reverse_Pi
	movt	r4, #:upper16:_reverse_Pi
	mov r3, 0
.cycle2:	
	cmp	r3, #15                @i > 15 ?
	bgt.n	.exit2
	ldrb	r2, [r0,r3]        @r2 = in_data[i]
	ldrb r2, [r4, r2]          @r2 = Pi[in_data[i]];
	strb r2, [r1,r3]
	adds	r3, #1
	b .cycle2
.exit2:
	nop
	pop {r3,r4}
	bx       lr
	.fnend
	.global	_GOST_Kuz_X
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_X, %function
_GOST_Kuz_X:
	.fnstart
	push {r3,r4,r5}
	mov r3, 0
.cycle3:	
	cmp	r3, #15                @i > 15 ?
	bgt.n	.exit3
	ldrb	r4, [r0,r3]        @a[i]
	ldrb	r5, [r1,r3]        @b[i]
	eor r4, r4, r5             @a[i] ^ b[i]
	strb r4, [r2,r3]
	adds	r3, #1
	b .cycle3
.exit3:
	nop
	pop {r3,r4,r5}
	bx       lr
	.fnend
	.global	_GOST_Kuz_GF_mul
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_GF_mul, %function
_GOST_Kuz_GF_mul:
	.fnstart
	push {r3,r4,r5}
	mov r3, 0
	mov r4, 0				   @c = 0;
.cycle4:	
	cmp	r3, #7                @i > 15 ?
	bgt.n	.exit4
	tst r1, #1
	beq.n .la1
	eor r4, r4, r0			@c ^= a;
.la1:
	and r5, r0, #128			@hi_bit = a & 0x80;
	lsl r0, r0, #1			@a <<= 1;
	tst r5, #255
	beq.n .la2
	eor r0, r0, #195	@a ^= 0xc3
.la2:
	lsr r1, r1, 1
	adds	r3, #1
	b .cycle4
.exit4:
	nop
	mov	r0, r4
	and r0, #255
	pop {r3,r4,r5}
	bx       lr
	.fnend
	.global	_GOST_Kuz_R
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_R, %function
_GOST_Kuz_R:
	.fnstart
	push {lr}
	push {r1,r2,r3,r4,r5,r6,r7}
	sub sp, sp, #20
	add r7, sp, #4
	movw	r2, #:lower16:_l_vec
	movt	r2, #:upper16:_l_vec
	mov r6, #0			@a_15 = 0;
	mov r3, #15
.cycle5:
	cmp	r3, #0
	blt.n .la4
	ldrb r4, [r0,r3]      @state[i];
	cmp	r3, #0
	beq.n .la3
	sub r3, r3, #1
	strb r4, [r7, r3]     @internal[i - 1]
	add	r3, r3, 1
.la3:
	mov r5, r0
	mov r0, r4
	ldrb r1, [r2, r3]     @l_vec[i]
	bl _GOST_Kuz_GF_mul
	eor r6, r6, r0
	mov r0, r5
	sub	r3, #1
	b .cycle5
.la4:
	nop
	strb r6, [r7, #15]	  @internal[15] = a_15
	mov r3, #0
.copy1:
	cmp r3, #15
	bgt.n .exit5
	ldrb r4, [r7,r3]
	strb r4, [r0,r3]
	add	r3, r3, 1
	b .copy1
.exit5:
	nop
	add	sp, sp, #20
	pop {r1,r2,r3,r4,r5,r6,r7}
	pop {lr}
	bx       lr
	.fnend
	.global	_GOST_Kuz_reverse_R
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_reverse_R, %function
_GOST_Kuz_reverse_R:
	.fnstart
	push {lr}
	push {r1,r2,r3,r4,r5,r6,r7}
	sub sp, sp, #20
	add r7, sp, #4
	movw	r2, #:lower16:_l_vec
	movt	r2, #:upper16:_l_vec
	ldrb r6, [r0, #15]		@a_0 = state[15];
	mov r3, #0
	strb r3, [r7]			@internal[0] = 0;
.cycle6:
	cmp	r3, #15
	bgt.n .la6
	cmp	r3, #0
	beq.n .la5
	sub r3, r3, #1
	ldrb r4, [r0, r3]	  @state[i - 1]
	add	r3, r3, 1
	strb r4, [r7, r3]     @internal[i]
.la5:
	mov r5, r0
	ldrb r0, [r7, r3]     @internal[i]
	ldrb r1, [r2, r3]     @l_vec[i]
	bl _GOST_Kuz_GF_mul
	eor r6, r6, r0
	mov r0, r5
	add	r3, #1
	b .cycle6
.la6:
	nop
	strb r6, [r7]		  @internal[0] = a_0
	mov r3, #0
.copy2:
	cmp r3, #15
	bgt.n .exit6
	ldrb r4, [r7,r3]
	strb r4, [r0,r3]
	add	r3, r3, 1
	b .copy2
.exit6:
	nop
	add	sp, sp, #20
	pop {r1,r2,r3,r4,r5,r6,r7}
	pop {lr}
	bx       lr
	.fnend
	.global	_GOST_Kuz_L
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_L, %function
_GOST_Kuz_L:
	.fnstart
	push {lr}
	push {r1,r2,r3,r4,r5,r6,r7}
	sub sp, sp, #20
	add r7, sp, #4			@internal
	mov r3, #0
.copy3:
	cmp r3, #15
	bgt.n .la7
	ldrb r4, [r0,r3]
	strb r4, [r7,r3]
	add	r3, r3, 1
	b .copy3
.la7:
	nop
	mov r3, #0
.cycle7:
	cmp	r3, #15
	bgt .la8
	mov r5, r0
	mov r0, r7
	bl _GOST_Kuz_R
	mov r0, r5
	add	r3, #1
	b .cycle7
.la8:
	nop
	mov r3, #0
.copy4:
	cmp r3, #15
	bgt.n .la9
	ldrb r4, [r7,r3]
	strb r4, [r1,r3]
	add	r3, r3, 1
	b .copy4
.la9:
	nop
	add	sp, sp, #20
	pop {r1,r2,r3,r4,r5,r6,r7}
	pop {lr}
	bx       lr
	.fnend
	.global	_GOST_Kuz_reverse_L
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_reverse_L, %function
_GOST_Kuz_reverse_L:
	.fnstart
	push {lr}
	push {r1,r2,r3,r4,r5,r6,r7}
	sub sp, sp, #20
	add r7, sp, #4			@internal
	mov r3, #0
.copy5:
	cmp r3, #15
	bgt.n .la10
	ldrb r4, [r0,r3]
	strb r4, [r7,r3]
	add	r3, r3, #1
	b .copy5
.la10:
	nop
	mov r3, #0
.cycle8:
	cmp	r3, #15
	bgt .la11
	mov r5, r0
	mov r0, r7
	bl _GOST_Kuz_reverse_R
	mov r0, r5
	add	r3, #1
	b .cycle8
.la11:
	nop
	mov r3, #0
.copy6:
	cmp r3, #15
	bgt.n .la12
	ldrb r4, [r7,r3]
	strb r4, [r1,r3]
	add	r3, r3, #1
	b .copy6
.la12:
	nop
	add	sp, sp, #20
	pop {r1,r2,r3,r4,r5,r6,r7}
	pop {lr}
	bx       lr
	.fnend

	.global	_GOST_Kuz_Get_C
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_Get_C, %function
_GOST_Kuz_Get_C:
	.fnstart
	push {lr}
	push {r0,r1,r2,r3,r4,r5,r6,r7}
	sub sp, sp, #516
	add r7, sp, #4			@iter_num[32];
	mov r3, #0
.cycle9:
	cmp r3, #31
	bgt.n .la14
	mov r5, #16
	mul r5, r3, r5
	add r5, r5, r7			@iter_num[i]
	mov r4, #0
	mov r6, #0
.zero0:
	cmp r4, #15
	bgt.n .la13
	strb r6, [r5, r4]		@memset(iter_num[i], 0, BLOCK_SIZE);
	add r4, r4, #1
	b .zero0
.la13:
	nop
	add r6, r3, #1
	strb r6, [r5]			@iter_num[i][0] = i+1;
	add r3, r3, #1
	b .cycle9
.la14:
	nop
	movw	r2, #:lower16:_iter_C
	movt	r2, #:upper16:_iter_C
	mov r3, #0
.cycle10:
	cmp r3, #31
	bgt.n .la15
	mov r0, #16
	mul r0, r3, r0
	add r0, r0, r7			@iter_num[i]
	mov r1, #16
	mul r1, r3, r1
	add r1, r1, r2			@iter_C[i]
	bl _GOST_Kuz_L
	add r3, r3, #1
	b .cycle10
.la15:
	nop
	add	sp, sp, #516
	pop {r0,r1,r2,r3,r4,r5,r6,r7}
	pop {lr}
	bx       lr
	.fnend
	.global	_GOST_Kuz_F
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_F, %function
_GOST_Kuz_F:
	.fnstart
	push {lr}
	push {r0,r1,r2,r3,r4,r5,r6,r7}
	sub sp, sp, #36
	str r0, [sp,#4]		@in_key_1
	str r1, [sp,#8]		@in_key_2
	str r2, [sp,#12]	@out_key_1
	str r3, [sp,#16]	@out_key_2
	add r7, sp, #20			@internal
	mov r4, #0
.copy7:
	cmp r4, #15
	bgt.n .la16
	ldrb r5, [r0,r4]
	strb r5, [r3,r4]		@memcpy(out_key_2, in_key_1, BLOCK_SIZE);
	add r4, r4, 1
	b .copy7
.la16:
	nop
	ldr r1, [sp, #72]
	mov r2, r7
	bl _GOST_Kuz_X
	mov r0, r7
	mov r1, r0
	bl _GOST_Kuz_S
	mov r0, r7
	mov r1, r0
	bl _GOST_Kuz_L
	mov r0, r7
	ldr r1, [sp,#8]
	ldr r2, [sp,#12]
	bl _GOST_Kuz_X
	add	sp, sp, #36
	pop {r0,r1,r2,r3,r4,r5,r6,r7}
	pop {lr}
	bx       lr
	.fnend
	.global	_GOST_Kuz_Expand_Key
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_Expand_Key, %function
_GOST_Kuz_Expand_Key:
	.fnstart
	push {lr}
	push {r0,r1,r2,r3,r4,r5,r6,r7}
	sub sp, sp, #268
	str r0, [sp, #4]					@key_1
	str r1, [sp, #8]					@key_2
	bl _GOST_Kuz_Get_C
	ldr r0, [sp, #4]					@key_1
	movw	r4, #:lower16:_iter_key		@iter_key[0]
	movt	r4, #:upper16:_iter_key				
	mov r3, #0
.cycle11:
	cmp r3, #15
	bgt.n .la17
	ldrb r1, [r0,r3]
	strb r1, [r4,r3]					@memcpy(iter_key[0], key_1, 16);
	add r3, r3, #1
	b .cycle11
.la17:
	nop
	ldr r0, [sp, #8]					@key_2
	add r4, #16							@iter_key[1]
	mov r3, #0
.cycle12:
	cmp r3, #15
	bgt.n .la18
	ldrb r1, [r0,r3]
	strb r1, [r4,r3]					@memcpy(iter_key[1], key_2, 16);
	add r3, r3, #1
	b .cycle12
.la18:
	nop
	add r0, sp, #12						@iter_1
	ldr r1, [sp, #4]					@key_1
	mov r3, #0
.copy8:
	cmp r3, #15
	bgt.n .la19
	ldrb r4, [r1,r3]
	strb r4, [r0,r3]					@memcpy(iter_1, key_1, 16);
	add r3, r3, #1
	b .copy8
.la19:
	nop
	add r0, sp, #76						@iter_2
	ldr r1, [sp, #8]					@key_2
	mov r3, #0
.copy9:
	cmp r3, #15
	bgt.n .la20
	ldrb r4, [r1,r3]
	strb r4, [r0,r3]					@memcpy(iter_2, key_2, 16);
	add r3, r3, #1
	b .copy9
.la20:
	nop
	movw	r4, #:lower16:_iter_C
	movt	r4, #:upper16:_iter_C
	movw	r6, #:lower16:_iter_key
	movt	r6, #:upper16:_iter_key
	mov r5, #0
.cycle13:
	cmp r5, #3
	bgt .la23
	mov r0, #8
	mul r0, r0, r5						@8 * i
	add r0, r0, #0						@0 + 8 * i
	mov r1, #16
	mul r0, r0, r1						
	add r0, r4							@_iter_C[0 + 8 * i]
	str r0, [sp]
	add r0, sp, #12						@iter_1
	add r1, sp, #76						@iter_2
	add r2, sp, #140					@iter_3
	add r3, sp, #204					@iter_4
	bl _GOST_Kuz_F
	mov r0, #8
	mul r0, r0, r5						@8 * i
	add r0, r0, #1						@1 + 8 * i
	mov r1, #16
	mul r0, r0, r1						
	add r0, r4							@_iter_C[1 + 8 * i]
	str r0, [sp]
	add r0, sp, #140					@iter_3
	add r1, sp, #204					@iter_4
	add r2, sp, #12						@iter_1
	add r3, sp, #76						@iter_2
	bl _GOST_Kuz_F
	mov r0, #8
	mul r0, r0, r5						@8 * i
	add r0, r0, #2						@2 + 8 * i
	mov r1, #16
	mul r0, r0, r1						
	add r0, r4							@_iter_C[2 + 8 * i]
	str r0, [sp]
	add r0, sp, #12						@iter_1
	add r1, sp, #76						@iter_2
	add r2, sp, #140					@iter_3
	add r3, sp, #204					@iter_4
	bl _GOST_Kuz_F
	mov r0, #8
	mul r0, r0, r5						@8 * i
	add r0, r0, #3						@3 + 8 * i
	mov r1, #16
	mul r0, r0, r1						
	add r0, r4							@_iter_C[3 + 8 * i]
	str r0, [sp]
	add r0, sp, #140					@iter_3
	add r1, sp, #204					@iter_4
	add r2, sp, #12						@iter_1
	add r3, sp, #76						@iter_2
	bl _GOST_Kuz_F
	mov r0, #8
	mul r0, r0, r5						@8 * i
	add r0, r0, #4						@4 + 8 * i
	mov r1, #16
	mul r0, r0, r1						
	add r0, r4							@_iter_C[4 + 8 * i]
	str r0, [sp]
	add r0, sp, #12						@iter_1
	add r1, sp, #76						@iter_2
	add r2, sp, #140					@iter_3
	add r3, sp, #204					@iter_4
	bl _GOST_Kuz_F
	mov r0, #8
	mul r0, r0, r5						@8 * i
	add r0, r0, #5						@5 + 8 * i
	mov r1, #16
	mul r0, r0, r1						
	add r0, r4							@_iter_C[5 + 8 * i]
	str r0, [sp]
	add r0, sp, #140					@iter_3
	add r1, sp, #204					@iter_4
	add r2, sp, #12						@iter_1
	add r3, sp, #76						@iter_2
	bl _GOST_Kuz_F
	mov r0, #8
	mul r0, r0, r5						@8 * i
	add r0, r0, #6						@6 + 8 * i
	mov r1, #16
	mul r0, r0, r1						
	add r0, r4							@_iter_C[6 + 8 * i]
	str r0, [sp]
	add r0, sp, #12						@iter_1
	add r1, sp, #76						@iter_2
	add r2, sp, #140					@iter_3
	add r3, sp, #204					@iter_4
	bl _GOST_Kuz_F
	mov r0, #8
	mul r0, r0, r5						@8 * i
	add r0, r0, #7						@7 + 8 * i
	mov r1, #16
	mul r0, r0, r1						
	add r0, r4							@_iter_C[7 + 8 * i]
	str r0, [sp]
	add r0, sp, #140					@iter_3
	add r1, sp, #204					@iter_4
	add r2, sp, #12						@iter_1
	add r3, sp, #76						@iter_2
	bl _GOST_Kuz_F
	mov r0, #2
	mul r0, r0, r5						@2 * i
	add r0, r0, #2						@2 + 2 * i
	mov r1, #16
	mul r0, r0, r1	
	add r0, r6							@iter_key[2 * i + 2]
	add r1, sp, #12						@iter_1
	mov r3, #0
.copy10:
	cmp r3, #15
	bgt.n .la21
	ldrb r2, [r1,r3]
	strb r2, [r0,r3]					@memcpy(iter_key[2 * i + 2], iter_1, 16);
	add r3, r3, #1
	b .copy10
.la21:
	nop
	mov r0, #2
	mul r0, r0, r5						@2 * i
	add r0, r0, #3						@3 + 2 * i
	mov r1, #16
	mul r0, r0, r1	
	add r0, r6							@iter_key[2 * i + 2]
	add r1, sp, #76						@iter_2
	mov r3, #0
.copy11:
	cmp r3, #15
	bgt.n .la22
	ldrb r2, [r1,r3]
	strb r2, [r0,r3]					@memcpy(iter_key[2 * i + 3], iter_2, 16);
	add r3, r3, #1
	b .copy11
.la22:
	nop
	add r5, r5, #1
	b .cycle13
.la23:
	nop
	add	sp, sp, #268
	pop {r0,r1,r2,r3,r4,r5,r6,r7}
	pop {lr}
	bx       lr
	.fnend
	.global	_GOST_Kuz_Encript
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_Encript, %function
_GOST_Kuz_Encript:
	.fnstart
	push {lr}
	push {r0,r1,r2,r3,r4,r5,r6,r7}
	movw	r6, #:lower16:_iter_key
	movt	r6, #:upper16:_iter_key
	mov r3, #0
.copy12:
	cmp r3, #15
	bgt.n .la24
	ldrb r2, [r0,r3]
	strb r2, [r1,r3]					@memcpy(out_blk, blk, BLOCK_SIZE);
	add r3, r3, #1
	b .copy12
.la24:
	nop
	mov r3, #0
.cycle14:
	cmp r3, #8
	bgt.n .la25
	mov r4, #16
	mul r5, r4, r3
	add r5, r5, r6				@_iter_key[i]
	mov r0, r5
	mov r2, r1
	bl _GOST_Kuz_X
	mov r0, r1
	bl _GOST_Kuz_S
	bl _GOST_Kuz_L
	add r3, r3, #1
	b .cycle14
.la25:
	nop
	mov r0, r1
	mov r2, r1
	mov r1, #144
	add r1, r1, r6				@_iter_key[9]
	bl _GOST_Kuz_X
	pop {r0,r1,r2,r3,r4,r5,r6,r7}
	pop {lr}
	bx       lr
	.fnend
	.global	_GOST_Kuz_Decript
	.syntax unified
	.thumb
	.thumb_func
	.type	_GOST_Kuz_Decript, %function
_GOST_Kuz_Decript:
	.fnstart
	push {lr}
	push {r0,r1,r2,r3,r4,r5,r6,r7}
	movw	r6, #:lower16:_iter_key
	movt	r6, #:upper16:_iter_key
	mov r3, #0
.copy13:
	cmp r3, #15
	bgt.n .la26
	ldrb r2, [r0,r3]
	strb r2, [r1,r3]					@memcpy(out_blk, blk, BLOCK_SIZE);
	add r3, r3, #1
	b .copy13
.la26:
	nop
	mov r4, r1
	mov r0, r1
	mov r2, r1
	mov r1, #144
	add r1, r1, r6				@_iter_key[9]
	bl _GOST_Kuz_X
	mov r3, #8
.cycle15:
	cmp r3, #0
	blt.n .la27
	mov r0, r4
	mov r1, r4
	bl _GOST_Kuz_reverse_L
	mov r0, r4
	mov r1, r4
	bl _GOST_Kuz_reverse_S
	mov r1, r4
	mov r4, #16
	mul r5, r4, r3
	add r5, r5, r6				@_iter_key[i]
	mov r0, r5
	mov r2, r1
	mov r4, r1
	bl _GOST_Kuz_X
	sub r3, r3, #1
	b .cycle15
.la27:
	nop
	pop {r0,r1,r2,r3,r4,r5,r6,r7}
	pop {lr}
	bx       lr
	.fnend
